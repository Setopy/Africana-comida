import{b as S,a as p,A as f,j as e}from"./index-d9119759.js";import{r}from"./vendor-5fe3892a.js";import"./router-51faa6cb.js";const U=()=>{const{user:n,updateProfile:w}=S(),[d,m]=r.useState(!1),[x,t]=r.useState({type:"",text:""}),[u,y]=r.useState({name:"",email:"",phone:"",currentPassword:"",newPassword:"",confirmPassword:""}),[g,A]=r.useState([]),[l,j]=r.useState({street:"",city:"",state:"",postalCode:"",isDefault:!1}),[b,N]=r.useState(!1);r.useEffect(()=>{n&&(y({name:n.name||"",email:n.email||"",phone:n.phone||"",currentPassword:"",newPassword:"",confirmPassword:""}),h())},[n]);const h=async()=>{try{const s=await p.get(`${f}/api/users/address`);A(s.data)}catch(s){console.error("Error fetching addresses:",s)}},v=s=>{const{name:a,value:i}=s.target;y(o=>({...o,[a]:i}))},c=s=>{const{name:a,value:i,type:o,checked:F}=s.target;j(D=>({...D,[a]:o==="checkbox"?F:i}))},C=async s=>{s.preventDefault(),m(!0),t({type:"",text:""});try{const{name:a,phone:i}=u,o=await w({name:a,phone:i});o.success?t({type:"success",text:"Profile updated successfully"}):t({type:"error",text:o.message})}catch{t({type:"error",text:"Failed to update profile"})}finally{m(!1)}},P=async s=>{s.preventDefault(),m(!0);try{await p.post(`${f}/api/users/address`,l),j({street:"",city:"",state:"",postalCode:"",isDefault:!1}),N(!1),h(),t({type:"success",text:"Address added successfully"})}catch{t({type:"error",text:"Failed to add address"})}finally{m(!1)}},k=async s=>{try{await p.delete(`${f}/api/users/address/${s}`),h(),t({type:"success",text:"Address deleted successfully"})}catch{t({type:"error",text:"Failed to delete address"})}};return e.jsx("div",{className:"bg-amber-50 min-h-screen py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-amber-900 mb-8",children:"Your Profile"}),x.text&&e.jsx("div",{className:`mb-6 p-4 rounded-md ${x.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:x.text}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-amber-900 mb-4",children:"Personal Information"}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:u.name,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-amber-500 focus:border-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",name:"email",value:u.email,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100",disabled:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Email cannot be changed"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:u.phone,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-amber-500 focus:border-amber-500"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",disabled:d,className:`px-6 py-2 bg-amber-600 text-white rounded-md ${d?"opacity-70 cursor-not-allowed":"hover:bg-amber-700"}`,children:d?"Updating...":"Update Profile"})})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-amber-900",children:"Your Addresses"}),e.jsx("button",{onClick:()=>N(!b),className:"text-amber-600 hover:text-amber-700 flex items-center",children:b?"Cancel":"Add New Address"})]}),b&&e.jsxs("form",{onSubmit:P,className:"mb-6 p-4 bg-amber-50 rounded-md",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"street",className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),e.jsx("input",{type:"text",id:"street",name:"street",value:l.street,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-amber-500 focus:border-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",id:"city",name:"city",value:l.city,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-amber-500 focus:border-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"state",className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),e.jsx("input",{type:"text",id:"state",name:"state",value:l.state,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-amber-500 focus:border-amber-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"postalCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code"}),e.jsx("input",{type:"text",id:"postalCode",name:"postalCode",value:l.postalCode,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-amber-500 focus:border-amber-500",required:!0})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"isDefault",checked:l.isDefault,onChange:c,className:"h-4 w-4 text-amber-600 focus:ring-amber-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Set as default address"})]})}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"submit",disabled:d,className:`px-6 py-2 bg-amber-600 text-white rounded-md ${d?"opacity-70 cursor-not-allowed":"hover:bg-amber-700"}`,children:d?"Adding...":"Add Address"})})]}),g.length>0?e.jsx("div",{className:"space-y-4",children:g.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-md p-4",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.street}),e.jsx("p",{className:"text-gray-600",children:`${s.city}, ${s.state} ${s.postalCode}`}),s.isDefault&&e.jsx("span",{className:"inline-block mt-1 px-2 py-1 bg-amber-100 text-amber-800 text-xs rounded-full",children:"Default"})]}),e.jsx("button",{onClick:()=>k(s._id),className:"text-red-600 hover:text-red-800",children:"Delete"})]})},s._id))}):e.jsx("p",{className:"text-gray-600",children:"You haven't added any addresses yet."})]})})]})})};export{U as default};
