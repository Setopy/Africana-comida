import{u as v,b as N,j as e,a as w,A as k}from"./index-d9119759.js";import{r as c}from"./vendor-5fe3892a.js";import{u as C}from"./router-51faa6cb.js";const q=()=>{const x=C(),{cart:l,totalPrice:p,clearCart:y}=v(),{user:r,isAuthenticated:F}=N(),[m,h]=c.useState(!1),[u,i]=c.useState(""),[s,g]=c.useState({name:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",phone:(r==null?void 0:r.phone)||"",address:"",paymentMethod:"cash",deliveryInstructions:""}),t=a=>{const{name:n,value:o}=a.target;g(d=>({...d,[n]:o}))},f=async a=>{var n,o;if(a.preventDefault(),l.length===0){i("Your cart is empty");return}h(!0),i("");try{const d={customer:{name:s.name,email:s.email,phone:s.phone,address:s.address},items:l.map(b=>({menuItem:b.id,quantity:b.quantity})),paymentMethod:s.paymentMethod,deliveryInstructions:s.deliveryInstructions},j=await w.post(`${k}/api/orders`,d);y(),x(`/order-confirmation/${j.data._id}`)}catch(d){console.error("Error creating order:",d),i(((o=(n=d.response)==null?void 0:n.data)==null?void 0:o.message)||"Failed to place order. Please try again.")}finally{h(!1)}};return l.length===0?(x("/cart"),null):e.jsx("div",{className:"bg-amber-50 min-h-screen py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-amber-900 mb-6",children:"Checkout"}),u&&e.jsx("div",{className:"mb-6 p-4 bg-red-100 text-red-700 rounded-md",children:u}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsx("div",{children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-amber-900 mb-4",children:"Order Summary"}),l.map(a=>e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200 last:border-b-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["$",a.price.toFixed(2)," x ",a.quantity]})]}),e.jsxs("p",{className:"font-medium",children:["$",(a.price*a.quantity).toFixed(2)]})]},a.id))]}),e.jsx("div",{className:"bg-gray-50 p-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("p",{children:"Total"}),e.jsxs("p",{children:["$",p.toFixed(2)]})]})})]})}),e.jsx("div",{children:e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsxs("form",{onSubmit:f,className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-amber-900 mb-4",children:"Delivery Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:s.name,onChange:t,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:t,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:s.phone,onChange:t,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Delivery Address"}),e.jsx("textarea",{id:"address",name:"address",value:s.address,onChange:t,required:!0,rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"deliveryInstructions",className:"block text-sm font-medium text-gray-700",children:"Delivery Instructions (Optional)"}),e.jsx("textarea",{id:"deliveryInstructions",name:"deliveryInstructions",value:s.deliveryInstructions,onChange:t,rows:2,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"cash",name:"paymentMethod",type:"radio",value:"cash",checked:s.paymentMethod==="cash",onChange:t,className:"focus:ring-amber-500 h-4 w-4 text-amber-600 border-gray-300"}),e.jsx("label",{htmlFor:"cash",className:"ml-3 block text-sm font-medium text-gray-700",children:"Cash on Delivery"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"card",name:"paymentMethod",type:"radio",value:"card",checked:s.paymentMethod==="card",onChange:t,className:"focus:ring-amber-500 h-4 w-4 text-amber-600 border-gray-300"}),e.jsx("label",{htmlFor:"card",className:"ml-3 block text-sm font-medium text-gray-700",children:"Credit/Debit Card"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"mobile",name:"paymentMethod",type:"radio",value:"mobile",checked:s.paymentMethod==="mobile",onChange:t,className:"focus:ring-amber-500 h-4 w-4 text-amber-600 border-gray-300"}),e.jsx("label",{htmlFor:"mobile",className:"ml-3 block text-sm font-medium text-gray-700",children:"Mobile Payment"})]})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",disabled:m,className:`w-full px-6 py-3 bg-amber-600 text-white font-medium rounded-lg ${m?"opacity-70 cursor-not-allowed":"hover:bg-amber-700"}`,children:m?"Processing...":"Place Order"})})]})})})]})]})})};export{q as default};
