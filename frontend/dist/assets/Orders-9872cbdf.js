import{j as e,O as b,a as o,A as m}from"./index-d9119759.js";import{r as l}from"./vendor-5fe3892a.js";import{L as x}from"./router-51faa6cb.js";const y=()=>{const[n,c]=l.useState([]),[h,d]=l.useState(!0),[i,u]=l.useState("");l.useEffect(()=>{(async()=>{try{d(!0);const t=await o.get(`${m}/api/orders/customer/${encodeURIComponent(localStorage.getItem("email")||"")}`);c(t.data)}catch(t){console.error("Error fetching orders:",t),u("Failed to load your orders. Please try again later.")}finally{d(!1)}})()},[]);const p=async s=>{var t,r;try{await o.post(`${m}/api/orders/${s}/cancel`),c(n.map(a=>a._id===s?{...a,status:"cancelled"}:a))}catch(a){console.error("Error cancelling order:",a),alert("Failed to cancel order. "+(((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Please try again later."))}};return h?e.jsx("div",{className:"bg-amber-50 min-h-screen py-16 flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-amber-600"})}):e.jsx("div",{className:"bg-amber-50 min-h-screen py-12",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-amber-900 mb-8",children:"Your Orders"}),i&&e.jsx("div",{className:"mb-6 p-4 bg-red-100 text-red-700 rounded-md",children:i}),n.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"You haven't placed any orders yet."}),e.jsx(x,{to:"/menu",className:"px-6 py-2 bg-amber-600 text-white font-medium rounded-lg hover:bg-amber-700",children:"Browse Our Menu"})]}):e.jsx("div",{className:"space-y-6",children:n.map(s=>{const t=b[s.status]||{color:"gray",text:s.status};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsxs("h2",{className:"text-lg font-semibold text-amber-900 mr-3",children:["Order #",s._id.slice(-6)]}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full bg-${t.color}-100 text-${t.color}-800 text-sm font-medium`,children:t.text})]}),e.jsxs("p",{className:"text-gray-600",children:["Placed on: ",new Date(s.createdAt).toLocaleString()]})]}),e.jsxs("div",{className:"mt-3 sm:mt-0",children:[e.jsx(x,{to:`/order-confirmation/${s._id}`,className:"text-amber-600 hover:text-amber-700 font-medium mr-4",children:"View Details"}),(s.status==="pending"||s.status==="confirmed")&&e.jsx("button",{onClick:()=>p(s._id),className:"text-red-600 hover:text-red-800 font-medium",children:"Cancel Order"})]})]})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsx("p",{className:"font-medium mb-2",children:"Order Summary:"}),e.jsx("ul",{className:"space-y-1 mb-4",children:s.items.map((r,a)=>e.jsxs("li",{className:"text-gray-600",children:[r.quantity,"x ",r.name]},a))}),e.jsxs("div",{className:"flex justify-between border-t border-gray-100 pt-3",children:[e.jsx("p",{className:"font-medium",children:"Total:"}),e.jsxs("p",{className:"font-bold text-amber-900",children:["$",s.totalAmount.toFixed(2)]})]})]})]},s._id)})})]})})};export{y as default};
